(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=o(i);fetch(i.href,n)}})();let h=null;window.addEventListener("gamepadconnected",t=>{h=t.gamepad.index});window.addEventListener("gamepaddisconnected",t=>{h===t.gamepad.index&&(h=null)});function Y(){const t=navigator.getGamepads?navigator.getGamepads():[];return t&&h!=null&&t[h]?t[h]:null}const c=Object.create(null),d=Object.create(null);document.addEventListener("keydown",t=>{c[t.key]=!0});document.addEventListener("keyup",t=>{c[t.key]=!1,d[t.key]=!1});const A=.15;function K(t){let e=0;_("q")&&(d.q=!0,e=-1),_("e")&&(d.e=!0,e=1),_("h")&&(d.h=!0,t.odomData=!t.odomData),t.maxAccel+=e}let f=0;function Z(t){return _("f")&&(d.f=!0,f++,f>=t.length&&(f=0)),t[f].render(),t[f]}function z(t,e,o,r){const i=t.axes,n=O(-i[1],A),a=O(i[2],A);e.tankDrive(n+a,n-a,o,r)}function J(t,e,o){const r=Y();if(r)return z(r,t,e,o);let i=0,n=0;c.w&&(i+=1),c.s&&(i-=1),c.d&&(n+=.5),c.a&&(n-=.5);const a=i+n,p=i-n;t.tankDrive(a,p,e,o)}const u=document.getElementById("canvas"),s=u.getContext("2d"),w=4,E=144*w,Q=144*w;u.width=E;u.height=Q;const U=1.5,tt=96;function l(t){return t/(E/w/(U*w))*tt}function F(t){return l(t+72)}function I(t){return l(72-t)}function et(t){return(t-90)*(Math.PI/180)}function it(t){return t*Math.PI/180}function nt(t){return t*180/Math.PI}function x(t,e,o){return Math.max(e,Math.min(o,t))}function st(t){return(t%360+360)%360}function O(t,e){return Math.abs(t)<e?0:t}function ot(t){var e=new Image;return e.src=t,e}function _(t){return c[t]&&!d[t]}function at(t,e){return!(t.x+t.w<=e.x||e.x+e.w<=t.x||t.y+t.h<=e.y||e.y+e.h<=t.y)}class rt{width;height;maxSpeed;trackWidth;x=0;y=0;angle=0;color;odomData=!0;vL=0;vR=0;maxAccel;maxDecel;constructor(e,o,r,i,n,a){this.width=e,this.height=o,this.maxSpeed=r,this.trackWidth=i,this.maxAccel=n,this.maxDecel=a,this.color="#969696ff"}set_x(e){this.x=x(e,-72+this.width/2,72-this.width/2)}set_y(e){this.y=x(e,-72+this.height/2,72-this.height/2)}set_angle(e){this.angle=(e%360+360)%360}get_x(){return this.x}get_y(){return this.y}get_angle(){return this.angle}moveTowards(e,o,r){const i=o-e;let a=(Math.abs(o)>Math.abs(e)?this.maxAccel:this.maxDecel)*r;return Math.abs(i)<=a?o:e+Math.sign(i)*a}tankDrive(e,o,r,i){const n=this.trackWidth,a=this.maxSpeed,p=x(e,-1,1),S=x(o,-1,1),W=p*a,$=S*a;this.vL=this.moveTowards(this.vL,W,i),this.vR=this.moveTowards(this.vR,$,i);const P=this.vL*12,R=this.vR*12;let T=(R+P)/2;const q=(P-R)/n,G=this.get_angle(),y=it(G),B=Math.sin(y),X=Math.cos(y),v=(H,V)=>({x:F(H-this.width/2),y:I(V+this.height/2),w:l(this.width),h:l(this.height)});let b=this.get_x(),L=this.get_y(),g=this.get_x()+T*B*i,m=this.get_y()+T*X*i;r.collision(v(g,m))?(r.collision(v(g,this.get_y()))||(b=g),r.collision(v(this.get_x(),m))||(L=m)):(b=g,L=m);const j=y+q*i;let k=nt(j);k=st(k),this.set_x(b),this.set_y(L),this.set_angle(k)}draw_odom_data(){s.save(),s.font="20px Calibri",s.fillStyle="white",s.textBaseline="top",s.fillText(`Î¸: ${this.get_angle().toFixed(2)}`,20,20),s.fillText(`X: ${this.get_x().toFixed(2)}`,20,45),s.fillText(`Y: ${this.get_y().toFixed(2)}`,20,70),s.fillText(`vL: ${this.vL.toFixed(2)}`,20,95),s.fillText(`vR: ${this.vR.toFixed(2)}`,20,120),s.fillText(`a: ${this.maxAccel.toFixed(2)}`,20,145),s.restore()}draw_chassis(){s.save(),s.translate(F(this.x),I(this.y)),s.rotate(et(this.angle)),s.fillStyle=this.color,s.fillRect(-l(this.width)/2,-l(this.height)/2,l(this.width),l(this.height)),s.beginPath(),s.moveTo(0,0),s.lineTo(l(this.width)/2,0),s.strokeStyle="black",s.lineWidth=2,s.stroke(),s.restore()}render(){this.draw_chassis(),this.odomData&&this.draw_odom_data()}}class D{img;obstacles;constructor(e,o=[]){this.img=ot(e),this.obstacles=o}collision(e){for(const o of this.obstacles)if(at(o,e))return!0;return!1}render(){s.drawImage(this.img,0,0,u.width,u.height)}}let M=new rt(14,14,6,16,18,25),lt=[new D("./push_back_skills.png",[{x:195,y:462,w:190,h:25},{x:195,y:88,w:190,h:25}]),new D("./empty_field.png"),new D("./high_stakes_skills.png")];function ct(t){const e=Z(lt);K(M),M.render(),J(M,e,t)}let C=0;const ht=60,dt=1e3/ht;function N(t){let e=t-C;e>=dt&&(C=t,ct(e/1e3)),window.requestAnimationFrame(N)}N(0);
